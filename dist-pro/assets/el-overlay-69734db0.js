import{E as t,aw as e,al as s,au as n,bq as o,av as i,S as a,a$ as u,by as c,X as l,ct as r,cK as d,cP as h,cL as f,ba as m,K as p,L as v,d as y,g,aa as _,I as w}from"./index-7aed846a.js";import{a as b}from"./scroll-e5847511.js";import{P as M}from"./vnode-c79bbe81.js";const E=(o,i,a)=>{let u={offsetX:0,offsetY:0};const c=t=>{const e=t.clientX,s=t.clientY,{offsetX:i,offsetY:a}=u,c=o.value.getBoundingClientRect(),l=c.left,r=c.top,d=c.width,h=c.height,f=document.documentElement.clientWidth,m=document.documentElement.clientHeight,p=-l+i,v=-r+a,y=f-l-d+i,g=m-r-h+a,_=t=>{const c=Math.min(Math.max(i+t.clientX-e,p),y),l=Math.min(Math.max(a+t.clientY-s,v),g);u={offsetX:c,offsetY:l},o.value.style.transform=`translate(${n(c)}, ${n(l)})`},w=()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",w)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",w)},l=()=>{i.value&&o.value&&i.value.removeEventListener("mousedown",c)};t((()=>{e((()=>{a.value?i.value&&o.value&&i.value.addEventListener("mousedown",c):l()}))})),s((()=>{l()}))},x=()=>{},k=Array.isArray;const S=t=>(t.w&Y)>0,L=t=>(t.n&Y)>0;let C=0,Y=1;const I=30;let R;class X{constructor(t,e=null,s){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,function(t,e=undefined){e&&e.active&&e.effects.push(t)}(this,s)}run(){if(!this.active)return this.fn();let t=R,e=j;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=R,R=this,j=!0,Y=1<<++C,C<=I?(({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Y})(this):z(this),this.fn()}finally{C<=I&&(t=>{const{deps:e}=t;if(e.length){let s=0;for(let n=0;n<e.length;n++){const o=e[n];S(o)&&!L(o)?o.delete(t):e[s++]=o,o.w&=~Y,o.n&=~Y}e.length=s}})(this),Y=1<<--C,R=this.parent,j=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){R===this?this.deferStop=!0:this.active&&(z(this),this.onStop&&this.onStop(),this.active=!1)}}function z(t){const{deps:e}=t;if(e.length){for(let s=0;s<e.length;s++)e[s].delete(t);e.length=0}}let j=!0;function A(t,e){(t!==R||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function P(t){const e=t&&t.__v_raw;return e?P(e):t}function T(t){j&&R&&function(t,e){let s=!1;C<=I?L(t)||(t.n|=Y,s=!S(t)):s=!t.has(R),s&&(t.add(R),R.deps.push(t))}((t=P(t)).dep||(t.dep=(t=>{const e=new Set(t);return e.w=0,e.n=0,e})()))}function $(t,e){const s=(t=P(t)).dep;s&&function(t,e){const s=k(t)?t:[...t];for(const n of s)n.computed&&A(n);for(const n of s)n.computed||A(n)}(s)}class B{constructor(t,e,s,n){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new X(t,(()=>{this._dirty||(this._dirty=!0,$(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=s}get value(){const t=P(this);return T(t),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}const H=(t,e={})=>{o(t)||i("[useLockscreen]","You need to pass a ref param to this function");const s=e.ns||a("popup"),n=function(t,e,s=!1){let n,o;const i="function"==typeof t;return i?(n=t,o=x):(n=t.get,o=t.set),new B(n,o,i||!o,s)}((()=>s.bm("parent","hidden")));if(!u||c(document.body,n.value))return;let m=0,p=!1,v="0";const y=()=>{setTimeout((()=>{f(null==document?void 0:document.body,n.value),p&&document&&(document.body.style.width=v)}),200)};l(t,(t=>{if(!t)return void y();p=!c(document.body,n.value),p&&(v=document.body.style.width),m=b(s.namespace.value);const e=document.documentElement.clientHeight<document.body.scrollHeight,o=r(document.body,"overflowY");m>0&&(e||"scroll"===o)&&p&&(document.body.style.width=`calc(100% - ${m}px)`),d(document.body,n.value)})),h((()=>y()))},O=t=>{if(!t)return{onClick:m,onMousedown:m,onMouseup:m};let e=!1,s=!1;return{onClick:n=>{e&&s&&t(n),e=s=!1},onMousedown:t=>{e=t.target===t.currentTarget},onMouseup:t=>{s=t.target===t.currentTarget}}},K=p({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:v([String,Array,Object])},zIndex:{type:v([String,Number])}});const q=y({name:"ElOverlay",props:K,emits:{click:t=>t instanceof MouseEvent},setup(t,{slots:e,emit:s}){const n=a("overlay"),{onClick:o,onMousedown:i,onMouseup:u}=O(t.customMaskEvent?void 0:t=>{s("click",t)});return()=>t.mask?g("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:o,onMousedown:i,onMouseup:u},[_(e,"default")],M.STYLE|M.CLASS|M.PROPS,["onClick","onMouseup","onMousedown"]):w("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[_(e,"default")])}});export{q as E,H as a,O as b,E as u};
